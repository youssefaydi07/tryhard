<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Chronomètre Minimaliste</title>

    <style>
        body {
            background-color: #0d0d0d;
            color: #eaeaea;
            font-family: "Inter", sans-serif;
            text-align: center;
            padding-top: 60px;
        }

        h1 {
            font-weight: 300;
            font-size: 28px;
            margin-bottom: 40px;
            letter-spacing: 1px;
            opacity: 0.9;
        }

        #chrono {
            font-size: 64px;
            font-family: "JetBrains Mono", monospace;
            background: #111;
            padding: 25px 50px;
            border-radius: 16px;
            display: inline-block;
            margin-bottom: 30px;
            box-shadow: 0 0 25px rgba(255,255,255,0.05);
        }

        .buttons {
            margin-top: 25px;
        }

        button {
            font-size: 17px;
            padding: 12px 30px;
            margin: 8px;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            transition: 0.25s;
            background: #1c1c1c;
            color: #fff;
            letter-spacing: 0.5px;
        }

        button:hover {
            transform: scale(1.08);
            filter: brightness(1.3);
        }

        #btnStart { background-color: #2ecc71; }
        #btnStop { background-color: #e74c3c; }
        #btnReset { background-color: #7f8c8d; }
        #btnAddTime { background-color: #2980b9; }

        #addSection {
            margin-top: 35px;
            background: #111;
            padding: 20px;
            border-radius: 14px;
            width: 300px;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 0 0 20px rgba(255,255,255,0.03);
        }

        #addSection input {
            width: 60px;
            padding: 8px;
            font-size: 16px;
            text-align: center;
            border-radius: 8px;
            background: #1c1c1c;
            border: 1px solid #333;
            color: #fff;
        }

        label {
            font-size: 14px;
            opacity: 0.8;
        }
    </style>
</head>

<body>

    <h1>Chronomètre Minimaliste</h1>

    <div id="chrono">00:00:00.00</div>

    <div class="buttons">
        <button id="btnStart">Démarrer</button>
        <button id="btnStop">Arrêter</button>
        <button id="btnReset">Réinitialiser</button>
    </div>

    <div id="addSection">
        <label>Ajouter du temps :</label><br><br>
        <input id="h" type="number" min="0" placeholder="hh"> :
        <input id="m" type="number" min="0" max="59" placeholder="mm"> :
        <input id="s" type="number" min="0" max="59" placeholder="ss">
        <br><br>
        <button id="btnAddTime">Ajouter</button>
    </div>

    <script>
        let chrono = document.getElementById("chrono");

        let depart = null;
        let pauseTemps = 0;
        let enCours = false;
        let rafID = null;

        // --- Sauvegarde de l'état ---
        function saveState() {
            localStorage.setItem("enCours", enCours);
            localStorage.setItem("depart", depart);
            localStorage.setItem("pauseTemps", pauseTemps);
        }

        // --- Chargement de l'état ---
        function loadState() {
            let savedEnCours = localStorage.getItem("enCours");
            let savedDepart = localStorage.getItem("depart");
            let savedPause = localStorage.getItem("pauseTemps");

            if (savedEnCours !== null) enCours = savedEnCours === "true";
            if (savedDepart !== null) depart = parseInt(savedDepart);
            if (savedPause !== null) pauseTemps = parseInt(savedPause);

            if (enCours && depart) {
                rafID = requestAnimationFrame(maj);
            } else {
                afficher(pauseTemps);
            }
        }

        // --- Fonction d'affichage formaté ---
        function afficher(ecoule) {
            let h = Math.floor(ecoule / 3600000);
            let m = Math.floor((ecoule / 60000) % 60);
            let s = Math.floor((ecoule / 1000) % 60);
            let c = Math.floor((ecoule % 1000) / 10);

            chrono.innerHTML =
            `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}.${c.toString().padStart(2,'0')}`;
        }

        // --- Mise à jour du chronomètre ---
        function maj() {
            if (!enCours) return;

            let now = Date.now();
            let ecoule = now - depart + pauseTemps;
            afficher(ecoule);

            rafID = requestAnimationFrame(maj);
        }

        // --- Boutons ---
        document.getElementById("btnStart").onclick = () => {
            if (!enCours) {
                enCours = true;
                depart = Date.now();
                saveState();
                rafID = requestAnimationFrame(maj);
            }
        };

        document.getElementById("btnStop").onclick = () => {
            if (enCours) {
                enCours = false;
                pauseTemps += Date.now() - depart;
                saveState();
                cancelAnimationFrame(rafID);
            }
        };

        document.getElementById("btnReset").onclick = () => {
            enCours = false;
            cancelAnimationFrame(rafID);
            depart = null;
            pauseTemps = 0;
            saveState();
            chrono.innerHTML = "00:00:00.00";
        };

        // Ajout de temps
        document.getElementById("btnAddTime").onclick = () => {
            let h = parseInt(document.getElementById("h").value) || 0;
            let m = parseInt(document.getElementById("m").value) || 0;
            let s = parseInt(document.getElementById("s").value) || 0;

            let ajout = h * 3600000 + m * 60000 + s * 1000;

            pauseTemps += ajout;
            saveState();

            if (!enCours) {
                afficher(pauseTemps);
            }
        };

        // Charger l'état au démarrage
        loadState();
    </script>

</body>
</html>
